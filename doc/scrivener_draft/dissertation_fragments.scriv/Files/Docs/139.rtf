{\rtf1\ansi\ansicpg1252\cocoartf1187\cocoasubrtf400
{\fonttbl\f0\fnil\fcharset0 Cochin;}
{\colortbl;\red255\green255\blue255;}
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\fi360\sl288\slmult1\pardirnatural

\f0\fs28 \cf0 ##Pose + Branch Location Particles\
\
Pose + Small grid of branch locations.  Evaluated by overlapCost of full medial axis of child on parent.\
\
The next parameter of the shoot map that we wish to represent as a belief distribution is the branches and their branch locations.  Specifically, we assume that whether a branch exists is a given and is taken as completely true for a particular map.  The only question that remains is at what point does a new shoot branch from a parent shoot.\
\
Given a parent shoot A and a child shoot B, what point on the shoot curve A does the shoot B branch from.  A related question is, at what angle does shoot B branch at from the branch point on shoot A?  The branch point can be uniquely described as a 3-tuple: \\\\( (x,y,\\theta) \\\\).   Similar to [](#particle_filter), we can reduce the problem state space by only considering points on the curve of shoot A.  Therefore, a branch point can be uniquely described with the 2-tuple: \\\\( (u, \\theta) \\\\).\
\
Our approach is to discretize the \\\\(u\\\\)-space over the parent shoot curve, making a finite number of possible branch locations.  Choosing the correct granularity is critical.  If the discretization is too sparse, it is possible that the correct branch location is missing from the possible locations.  If the discretization is too dense, it will be too computationally costly to evaluate all possible locations.\
\
An example of the discretized space over branch locations is shown in Figure X.  Here the entire child shoot medial axis graph is shown with a weighted rendering corresponding to the location's fitness.  Locations that overlap with the parent shoot are more likely.  Locations where the child and parent don't overlap are evaluated as unlikely.\
\
It is also clear from Figure X that there are is a large swath of possible locations that are not worth considering.  For instance, the entire range of branch locations where the overlap is zero have virtually zero chance of being correct.  It would be helpful if we could disregard this locations so that we need not continue to evaluate them during our computation.  This can save on computational costs.\
\
However, the question still remains, what set of possible branch locations *should* we keep track of?  It helps to consider where information about branch locations come from in the first place.\
\
Once a branching condition has been detected by a particular posture image and pose, a new branch point is created with respect to the pose.  Therefore, branch points are conditionally dependent on poses.  For a particular pose hypothesis, we must create a range of possible branch point hypotheses.  That is, from pose X, the branch point detected at X' is located on the curve at u'.  Therefore, we track a range of discrete branch point values around u'.  In our implementation, we keep track of 11 possible values for a given pose hypothesis.  We keep track of 40 pose hypotheses in the particle filter.  This creates 11*40 possible branch points.  Many of these branch points are identical.\
\
To save on computational costs, we identify identical branch point hypotheses and only evaluate them once.  This provides an upper bound to the number of possible branch point evaluations to the total number of bins on the discretized u-space of the shoot curve.\
\
You may notice that this discretization over u-space does not provide any considerations to the angle of the branch point.  There are two types of angular considerations for branch points.  The first is the child shoot's angle of divergence from the parent shoot.  This is generated from the medial axis computation of the union of posture images.  It is a byproduct of the shoot generation process and is not directly controllable.  Therefore it is not considered as part of the branch space.  \
\
The second angular consideration is that the set of posture images that constitute the child shoot may misalign with the parent shoot by some rotational transformation.  While this is possible, it is our experience that the relative angular relationship of fitted posture curves and shoot curves remains fairly stable on a local level.  Should there be some angular discrepancy, this is usually symptomatic of degenerate map state and should be pruned from consideration.\
\
Evaluation of *shoot skeleton* and parent shoot curve.   Evaluation cost = matchCount * overlapSum .  \
\
Secondary complementary observation of junction.  Branch belief distribution should have site on consistent location.  Figure X shows the possible locations and Figure Y shows the final location and only possible consistent location.  Any poses that do not have the consistent location in branch space are given low probability score and are rejected by particle filter.  \
\
Maximum likelihood for non-branching map state tries to find the most consistent, non-branching fit.  Given that the new diverging posture curve is not going to create a new branch, of all the pose particles, what is the best fit location on the existing map.  Could resolve into two different child shoots, but we do not yet consider that.  Assume that each pose can only be assigned to one child shoot.\
\
Drawback to this approach: if there are insufficient number of particles to approximate the belief distribution over poses and branch points, correct branch point location may be unavailable in sample set when complementary junction observation occurs for a successful resolution to occur.  \
\
Another challenge is that branch points are considered independent between shoots.  Therefore, if a posture image is taken overlapping two sibling shoots, there is no mechanism to explicitly correlate this possibility.  Two branch space belief distributions are maintained independently and if there is significant representation over the sample space, it would be extraordinarily fortunate to identify the two pairs of branch point hypotheses that align to fit the single posture curve.\
\
Splices over branch hypotheses.  \
\
\
}